package br.ufu.facom.lascam.coverageexploiter;

import br.ufu.facom.lascam.coverageexploiter.analytics.CoverageMetrics;
import br.ufu.facom.lascam.coverageexploiter.extractor.ApiExtractor;
import br.ufu.facom.lascam.coverageexploiter.extractor.ExtractorFromJavaDoc;
import br.ufu.facom.lascam.coverageexploiter.posts.PostsRetriever;
import br.ufu.facom.lascam.coverageexploiter.posts.model.classifier.Pair;
import br.ufu.facom.lascam.coverageexploiter.util.Constants;
import net.htmlparser.jericho.Config;
import net.htmlparser.jericho.LoggerProvider;

import java.io.File;
import java.nio.file.Files;
import java.nio.file.Paths;
import java.util.Date;
import java.util.List;
import java.util.Map;
import java.util.Set;

/**
 * Created by Klerisson on 02/09/2014.
 */
public class Main {

    public static void main(String[] args){
        Config.LoggerProvider = LoggerProvider.DISABLED;
        try {

            System.out.println(new Date() + " Begin...");
            PostsRetriever postsRetriever = new PostsRetriever();
            List<Pair> postsPair = postsRetriever.fetchPosts();
            postsRetriever.parseBodies();
            System.out.println(new Date() + " Posts found: " + postsPair.size());

            ApiExtractor extractor = new ExtractorFromJavaDoc(Constants.JAVADOC_PATH,"javax.swing");
            extractor.extract();
            System.out.println(new Date() + " Api elements extracted: " + extractor.getClassesToMethodsMap().keySet().size());

            CoverageMetrics cs = new CoverageMetrics(postsPair, extractor);
            cs.evaluate();

            System.out.println(new Date() + "End.");

        } catch (Exception e){
            System.out.println("Application fail!");
            e.printStackTrace();
        }
    }

}
