package br.ufu.facom.lascam.coverageexploiter.parser.impl;

import br.ufu.facom.lascam.coverageexploiter.parser.Parser;
import br.ufu.facom.lascam.coverageexploiter.parser.model.ApiElement;
import br.ufu.facom.lascam.coverageexploiter.parser.model.ApiElements;

import java.util.ArrayList;
import java.util.List;
import java.util.regex.Matcher;
import java.util.regex.Pattern;

/**
 * Created by Klerisson on 11/11/2014.
 */
public class RegexAnalyser extends Parser {

    @Override
    public ApiElements parseSnippet(String statement) throws Exception {

        ApiElement apiElement = new ApiElement();
        List<String> elements = new ArrayList<>();

        //For qualified calls
//        Matcher m = Pattern.compile("(\\.[\\s\\n\\r]*[\\w]+)[\\s\\n\\r]*(?=\\(.*\\))").matcher(statement);
//        while(m.find()) {
//            System.out.println(m.group());
//            elements.add(m.group());
//            apiElement.setElements(elements);
//        }
        //For unqualified calls
        Matcher m = Pattern.compile("(?!\\bif\\b|\\bfor\\b|\\bwhile\\b|\\bswitch\\b|\\btry\\b|\\bcatch\\b)(\\b[\\w]+\\b)[\\s\\n\\r]*(?=\\(.*\\))").matcher(statement);
        while (m.find()) {
           // System.out.println(m.group());
            elements.add(m.group());
            apiElement.setElements(elements);
        }

        super.apiElements.getApiElements().add(apiElement);
        return super.apiElements;
    }
}
