package br.ufu.facom.lascam.coverageexploiter.posts.controller;

import br.ufu.facom.lascam.coverageexploiter.posts.model.Pair;
import br.ufu.facom.lascam.coverageexploiter.util.AppProperties;
import br.ufu.facom.lascam.coverageexploiter.util.Constants;
import com.thoughtworks.xstream.XStream;

import java.io.FileInputStream;
import java.io.InputStream;
import java.util.ArrayList;
import java.util.List;

/**
 * Created by Klerisson on 03/09/2014.
 */
public class PostsRetriever {

    private List<Pair> howToPairs;

    public PostsRetriever() {
        super();
    }

    public List<Pair> fetchPosts() throws Exception {

        try {
            String path = AppProperties.getProperty(Constants.POSTS_INPUT_PROP);
            InputStream in;
            if (path == null) {
                in = this.getClass().getResourceAsStream("/" + Constants.POSTS_INPUT_PATH);
            } else {
                in = new FileInputStream(path);
            }

            XStream xstream = new XStream();
            xstream.alias("list", ArrayList.class);
            xstream.alias("pair", Pair.class);
            howToPairs = (ArrayList<Pair>) xstream.fromXML(in);
            return howToPairs;

        } catch (Exception e) {
            throw e;
        }

    }
}
